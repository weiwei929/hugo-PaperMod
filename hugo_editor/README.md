# Hugo Editor 使用说明

## 🚀 快速开始

### 1. 环境要求

- **Node.js**: 版本 16.0.0 或更高
- **Hugo**: 已安装并配置好的 Hugo 项目
- **现代浏览器**: Chrome、Firefox、Safari、Edge 等

### 2. 安装和启动


#### 方法一：使用启动脚本（推荐）

1. 双击运行 `start-server.bat`
2. 脚本会自动检查环境并安装依赖
3. 服务器启动后，打开 `hugo-editor.html`

#### 方法二：手动启动（单进程合并版）

```bash
# 1. 安装依赖
cd hugo_editor
npm install

# 2. 启动统一服务器
npm start

# 3. 在浏览器中打开 hugo-editor.html
# 地址：http://127.0.0.1:8080/hugo-editor.html
```

### 3. 基本使用

1. **创建文章**: 填写标题、选择分类、编写内容
2. **插入图片**: 拖拽图片到上传区域或点击上传
3. **实时预览**: 右侧实时显示渲染效果
4. **一键导出**: 点击"导出到Hugo"直接保存到项目

## 📋 架构更新说明

2025年9月，项目已升级为单进程合并架构，统一由 `unified-server.js` 提供静态服务和 API 服务，端口为 8080。

原有 editor-server.js 和 file-server.js 已合并，启动和部署更简化，推荐使用新版启动方式。

---

## 📋 功能特性

### ✅ 已完成功能

#### 🔧 核心编辑功能
- ✅ Markdown 编辑器
- ✅ 实时预览
- ✅ 语法高亮
- ✅ 字数统计
- ✅ 阅读时间估算
- ✅ 自动保存
- ✅ 快捷键支持

#### 🖼️ 图片管理
- ✅ 拖拽上传
- ✅ 自动压缩优化
- ✅ 分类存储
- ✅ 路径自动生成
- ✅ 图片库管理
- ✅ 批量处理

#### 📁 文件集成
- ✅ 本地文件服务器
- ✅ 直接写入Hugo项目
- ✅ 路径验证和安全检查
- ✅ 错误处理和恢复
- ✅ 批处理脚本降级

#### 🎨 用户界面
- ✅ 响应式设计
- ✅ 分屏编辑
- ✅ 工具栏
- ✅ 状态栏
- ✅ 模态框
- ✅ 进度提示

### 🔄 工作流程

```
编辑文章 → 上传图片 → 实时预览 → 一键导出 → Hugo构建
```

## ⌨️ 快捷键

| 快捷键 | 功能 |
|--------|------|
| `Ctrl + S` | 保存文档 |
| `Ctrl + E` | 导出到Hugo |
| `Ctrl + B` | 粗体 |
| `Ctrl + I` | 斜体 |
| `Ctrl + K` | 插入链接 |
| `Ctrl + Shift + I` | 插入图片 |
| `Ctrl + `` ` `` | 代码 |
| `Ctrl + Shift + >` | 引用 |
| `Ctrl + L` | 列表 |
| `Ctrl + H` | 标题 |
| `F1` | 显示/隐藏快捷键提示 |

## 📝 模板系统

### 内置模板

1. **博客文章**: 标准的博客文章模板
2. **日记**: 个人日记模板
3. **项目介绍**: 项目展示模板

### 使用模板

1. 在编辑器顶部选择模板
2. 系统自动填充Front Matter和内容结构
3. 根据需要修改内容

### 自定义模板

编辑 `hugo-editor-config.yml` 文件中的 `templates` 部分：

```yaml
templates:
  my_template:
    name: "我的模板"
    description: "自定义模板描述"
    front_matter:
      title: ""
      date: "{{ now }}"
      tags: ["自定义"]
    content: |
      ## 自定义内容
      
      在这里写模板内容...
```

## 🖼️ 图片管理

### 支持格式
- JPEG (.jpg, .jpeg)
- PNG (.png)
- GIF (.gif)
- WebP (.webp)

### 自动优化
- **压缩**: JPEG 85%质量，PNG 6级压缩
- **尺寸**: 最大 1920x1080px
- **格式**: 自动转换为 WebP（如果浏览器支持）
- **命名**: 自动生成唯一文件名

### 分类存储

```
static/images/
├── posts/           # 文章图片
│   └── 2025/01/     # 按日期分组
├── covers/          # 封面图片
├── gallery/         # 图片欣赏
└── icons/           # 图标资源
```

## 🔧 配置说明

### 配置文件位置
`hugo_editor/hugo-editor-config.yml`

### 主要配置项

```yaml
# 编辑器配置
editor:
  auto_save_interval: 30        # 自动保存间隔（秒）
  syntax_highlighting: true     # 语法高亮
  word_count: true             # 字数统计
  reading_time: true           # 阅读时间

# 图片配置
image:
  auto_compress: true          # 自动压缩
  jpeg_quality: 85            # JPEG质量
  max_file_size: 10           # 最大文件大小(MB)
  max_width: 1920             # 最大宽度
  max_height: 1080            # 最大高度

# 服务器配置
server:
  port: 8081                  # 服务器端口
  host: "127.0.0.1"          # 服务器地址
  timeout: 10                 # 请求超时时间
```

## 🚨 故障排除

### 常见问题

#### 1. 文件服务器启动失败
**问题**: 端口 8081 被占用
**解决**: 
- 检查其他程序是否使用该端口
- 修改配置文件中的端口号
- 重启计算机

#### 2. 图片上传失败
**问题**: 图片无法上传
**解决**:
- 检查文件服务器是否运行
- 确认图片格式和大小符合要求
- 检查磁盘空间是否充足

#### 3. 导出功能不工作
**问题**: 无法导出到Hugo项目
**解决**:
- 确认在Hugo项目根目录下运行
- 检查文件权限
- 使用降级的下载模式

#### 4. 预览不显示
**问题**: 右侧预览区域空白
**解决**:
- 刷新页面
- 检查浏览器控制台错误
- 确认Markdown语法正确

### 日志查看

1. **浏览器控制台**: F12 → Console
2. **服务器日志**: 查看命令行输出
3. **错误信息**: 界面右上角的提示

## 🔄 更新和维护

### 定期维护

1. **清理缓存**: 定期清理浏览器缓存
2. **更新依赖**: `npm update`
3. **备份配置**: 备份 `hugo-editor-config.yml`
4. **检查更新**: 关注项目更新

### 性能优化

1. **图片优化**: 启用自动压缩
2. **缓存管理**: 定期清理图片缓存
3. **文件整理**: 定期整理上传的图片

## 📞 技术支持

### 获取帮助

1. **查看文档**: 阅读完整的技术文档
2. **检查日志**: 查看错误信息和日志
3. **重启服务**: 重启文件服务器
4. **重置配置**: 恢复默认配置

### 反馈问题

请提供以下信息：
- 操作系统版本
- Node.js版本
- Hugo版本
- 错误信息截图
- 操作步骤

## 📈 版本历史

### v2.0.0 (当前版本)
- ✅ 完整的文件服务器集成
- ✅ 增强的图片管理系统
- ✅ 模板系统
- ✅ 配置文件支持
- ✅ 快捷键系统
- ✅ 用户体验优化

### v1.0.0
- ✅ 基础Markdown编辑器
- ✅ 简单图片上传
- ✅ 基本导出功能

---

**Hugo Editor** - 让Hugo写作更简单 🚀
